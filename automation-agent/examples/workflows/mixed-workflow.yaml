name: mixed-multi-platform-workflow
timeout: 15m
tasks:
  # Health check
  - name: check-api-health
    type: http
    config:
      url: https://api.example.com/health
      expected_status: [200]
      timeout: 10s
      
  # Database check
  - name: verify-database
    type: db
    config:
      driver: mysql
      dsn: user:password@tcp(db.example.com:3306)/production
      query: SELECT COUNT(*) FROM users WHERE created_at > NOW() - INTERVAL 1 DAY
      timeout: 30s
      
  # Windows-specific deployment (only runs on Windows agents)
  - name: windows-update
    type: powershell
    config:
      script: |
        # Check if Windows
        if ($env:OS -eq "Windows_NT") {
          Write-Output "Running Windows deployment"
          # Your Windows-specific logic here
          exit 0
        } else {
          Write-Output "Not a Windows system, skipping"
          exit 0
        }
      timeout: 2m
      
  # Linux-specific deployment (for Linux agents)
  - name: linux-update
    type: ssh
    config:
      host: linux-server.example.com
      port: 22
      user: deploy
      key: /root/.ssh/id_rsa
      command: |
        cd /opt/myapp &&
        git pull origin main &&
        docker-compose restart
      timeout: 3m
      
  # Final verification
  - name: verify-deployment
    type: http
    config:
      url: https://api.example.com/version
      expected_status: [200]
      timeout: 10s
